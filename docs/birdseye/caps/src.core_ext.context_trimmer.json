{
  "id": "src/core_ext/context_trimmer.py",
  "role": "core",
  "public_api": [
    "trim_messages(messages, target_tokens, model)"
  ],
  "summary": "tiktoken ベースで履歴をトークン数に合わせてトリミングし、圧縮率やカウンタ情報を返す共通ユーティリティ。",
  "deps_out": [
    "tiktoken",
    "src/core_ext/context_trimmer._TokenCounter"
  ],
  "deps_in": [
    "src/app.py",
    "tests/core_ext/test_context_trimmer.py"
  ],
  "risks": [
    "tiktoken 非導入時はヒューリスティックで精度が低下する"
  ],
  "tests": [
    "tests/core_ext/test_context_trimmer.py"
  ],
  "generated_at": "2025-10-19T18:34:08Z"
}
